Some weights of the model checkpoint at microsoft/deberta-v3-large were not used when initializing DebertaV2Model: ['lm_predictions.lm_head.LayerNorm.bias', 'lm_predictions.lm_head.dense.weight', 'lm_predictions.lm_head.LayerNorm.weight', 'mask_predictions.classifier.bias', 'mask_predictions.classifier.weight', 'mask_predictions.LayerNorm.weight', 'lm_predictions.lm_head.bias', 'mask_predictions.dense.bias', 'mask_predictions.dense.weight', 'mask_predictions.LayerNorm.bias', 'lm_predictions.lm_head.dense.bias']
- This IS expected if you are initializing DebertaV2Model from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DebertaV2Model from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/qcqced/anaconda3/lib/python3.9/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]
  grad_norm = torch.nn.utils.clip_grad_norm(                                                                                    | 0/87 [00:00<?, ?it/s]
/home/qcqced/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:139: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "





















































































/home/qcqced/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:265: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  warnings.warn("To get the last learning rate computed by the scheduler, "
















 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 19/20 [00:32<00:01,  1.73s/it]
[1/20] Train Loss: 0.6636000275611877
[1/20] Valid Loss: 0.6263999938964844
[1/20] Pearson Score: 0.6044
[1/20] Gradient Norm: 77043.625
[1/20] lr: 2.5e-05
[Update] Valid Score : (-inf => 0.6044) Save Parameter
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 18/20 [00:31<00:03,  1.73s/it]
[2/20] Train Loss: 0.6028000116348267
[2/20] Valid Loss: 0.590399980545044
[2/20] Pearson Score: 0.6947
[2/20] Gradient Norm: 207316.703125
[2/20] lr: 5e-05
[Update] Valid Score : (0.6044 => 0.6947) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 19/20 [00:32<00:01,  1.73s/it]
[3/20] Train Loss: 0.5839999914169312
[3/20] Valid Loss: 0.5759000182151794
[3/20] Pearson Score: 0.7362
[3/20] Gradient Norm: 240052.921875
[3/20] lr: 4.849231551964771e-05
[Update] Valid Score : (0.6947 => 0.7362) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[4/20] Train & Validation














































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[4/20] Train Loss: 0.5716999769210815
[4/20] Valid Loss: 0.5771999955177307
[4/20] Pearson Score: 0.7564
[4/20] Gradient Norm: 121221.5390625
[4/20] lr: 4.415111107797445e-05
[Update] Valid Score : (0.7362 => 0.7564) Save Parameter
Best Score: 0.7564460051633557
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 18/20 [00:31<00:03,  1.73s/it]
[5/20] Train Loss: 0.5637000203132629
[5/20] Valid Loss: 0.5648000240325928
[5/20] Pearson Score: 0.7739
[5/20] Gradient Norm: 152808.859375
[5/20] lr: 3.7500000000000003e-05
[Update] Valid Score : (0.7564 => 0.7739) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 19/20 [00:32<00:01,  1.73s/it]
[6/20] Train Loss: 0.557200014591217
[6/20] Valid Loss: 0.5691999793052673
[6/20] Pearson Score: 0.7781
[6/20] Gradient Norm: 301622.71875
[6/20] lr: 2.9341204441673266e-05
[Update] Valid Score : (0.7739 => 0.7781) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[7/20] Train & Validation






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[7/20] Train Loss: 0.5532000064849854
[7/20] Valid Loss: 0.5587999820709229
[7/20] Pearson Score: 0.7858
[7/20] Gradient Norm: 219990.265625
[7/20] lr: 2.0658795558326743e-05
[Update] Valid Score : (0.7781 => 0.7858) Save Parameter
Best Score: 0.7857960527344953
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]

















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[8/20] Train Loss: 0.5508999824523926
[8/20] Valid Loss: 0.5612999796867371
[8/20] Pearson Score: 0.7886
[8/20] Gradient Norm: 163916.28125
[8/20] lr: 1.2500000000000006e-05
[Update] Valid Score : (0.7858 => 0.7886) Save Parameter
Best Score: 0.7886442165507733
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 18/20 [00:31<00:03,  1.73s/it]
[9/20] Train Loss: 0.5491999983787537
[9/20] Valid Loss: 0.5566999912261963
[9/20] Pearson Score: 0.7906
[9/20] Gradient Norm: 254986.3125
[9/20] lr: 5.848888922025553e-06
[Update] Valid Score : (0.7886 => 0.7906) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 19/20 [00:32<00:01,  1.73s/it]
[10/20] Train Loss: 0.5490000247955322
[10/20] Valid Loss: 0.5568000078201294
[10/20] Pearson Score: 0.7911
[10/20] Gradient Norm: 206324.09375
[10/20] lr: 1.5076844803522922e-06
[Update] Valid Score : (0.7906 => 0.7911) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[11/20] Train Loss: 0.5479999780654907
[11/20] Valid Loss: 0.5568000078201294
[11/20] Pearson Score: 0.791
[11/20] Gradient Norm: 465719.59375
[11/20] lr: 5e-05
[12/20] Train & Validation






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]

















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[12/20] Train Loss: 0.5519999861717224
[12/20] Valid Loss: 0.5532000064849854
[12/20] Pearson Score: 0.794
[12/20] Gradient Norm: 91379.0234375
[12/20] lr: 4.849231551964771e-05
[Update] Valid Score : (0.7911 => 0.7940) Save Parameter
Best Score: 0.7940363324840833
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 19/20 [00:32<00:01,  1.73s/it]
[13/20] Train Loss: 0.5446000099182129
[13/20] Valid Loss: 0.5509999990463257
[13/20] Pearson Score: 0.8011
[13/20] Gradient Norm: 228063.328125
[13/20] lr: 4.415111107797445e-05
[Update] Valid Score : (0.7940 => 0.8011) Save Parameter

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[14/20] Train & Validation






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[14/20] Train Loss: 0.5389999747276306
[14/20] Valid Loss: 0.5478000044822693
[14/20] Pearson Score: 0.8087
[14/20] Gradient Norm: 139550.1875
[14/20] lr: 3.750000000000001e-05
[Update] Valid Score : (0.8011 => 0.8087) Save Parameter
Best Score: 0.8087366684991604
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 18/20 [00:31<00:03,  1.73s/it]
[15/20] Train Loss: 0.5364999771118164
[15/20] Valid Loss: 0.5568000078201294
[15/20] Pearson Score: 0.8065
[15/20] Gradient Norm: 143990.796875
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[16/20] Train Loss: 0.5338000059127808
[16/20] Valid Loss: 0.5497999787330627
[16/20] Pearson Score: 0.8115
[16/20] Gradient Norm: 152256.46875
[16/20] lr: 2.0658795558326743e-05
[Update] Valid Score : (0.8087 => 0.8115) Save Parameter
Best Score: 0.8114587456547738
[17/20] Train & Validation






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]
[17/20] Train Loss: 0.5311999917030334
[17/20] Valid Loss: 0.550000011920929
[17/20] Pearson Score: 0.8089
[17/20] Gradient Norm: 201919.40625
[17/20] lr: 1.2499999999999996e-05






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 19/20 [00:32<00:01,  1.73s/it]
[18/20] Train Loss: 0.531000018119812
[18/20] Valid Loss: 0.5501000285148621
[18/20] Pearson Score: 0.8112
[18/20] Gradient Norm: 155758.4375
[18/20] lr: 5.848888922025553e-06
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
[19/20] Train Loss: 0.5295000076293945
[19/20] Valid Loss: 0.5490999817848206
[19/20] Pearson Score: 0.8116
[19/20] Gradient Norm: 173562.515625
[19/20] lr: 1.5076844803522922e-06
[Update] Valid Score : (0.8115 => 0.8116) Save Parameter
Best Score: 0.8115581444032179
  0%|                                                                                                                           | 0/87 [00:00<?, ?it/s]






















































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 87/87 [07:00<00:00,  4.83s/it]
















100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.32s/it]
  0%|                                                                                                                           | 0/20 [00:00<?, ?it/s]
[20/20] Train Loss: 0.5291000008583069
[20/20] Valid Loss: 0.5501999855041504
[20/20] Pearson Score: 0.8109
[20/20] Gradient Norm: 216756.015625















 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 18/20 [00:31<00:03,  1.73s/it]
Fold[1/4] SWA Loss: 0.7457000017166138

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:33<00:00,  1.31s/it]